float64[] out_state
float64[] in_state